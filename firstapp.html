<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>第 10 章 创建第一个Webx应用</title><link rel="stylesheet" type="text/css" href="docbook.css"/><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"/><link rel="home" href="index.html" title="Webx框架指南"/><link rel="up" href="pt04.html" title="部分 IV. Webx应用实作"/><link rel="prev" href="pt04.html" title="部分 IV. Webx应用实作"/><link rel="next" href="logging.html" title="第 11 章 Webx日志系统的配置"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第 10 章 创建第一个Webx应用</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="pt04.html">上一页</a> </td><th width="60%" align="center">部分 IV. Webx应用实作</th><td width="20%" align="right"> <a accesskey="n" href="logging.html">下一页</a></td></tr></table><hr/></div><div xml:lang="zh-CN" class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="webx.tutorial.simple"><!--anchor webx.tutorial.simple--></a>第 10 章 创建第一个Webx应用</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="firstapp.html#d0e14576">10.1. 准备工作</a></span></dt><dd><dl><dt><span class="section"><a href="firstapp.html#d0e14581">10.1.1. 安装JDK</a></span></dt><dt><span class="section"><a href="firstapp.html#d0e14588">10.1.2. 安装和配置maven</a></span></dt><dt><span class="section"><a href="firstapp.html#d0e14602">10.1.3. 安装集成开发环境</a></span></dt></dl></dd><dt><span class="section"><a href="firstapp.html#d0e14629">10.2. 创建应用</a></span></dt><dt><span class="section"><a href="firstapp.html#d0e14717">10.3. 运行应用</a></span></dt><dt><span class="section"><a href="firstapp.html#d0e14765">10.4. 提问和解答</a></span></dt><dd><dl><dt><span class="section"><a href="firstapp.html#d0e14768">10.4.1. 在生产环境的应用上，也会出现前述的“开发者首页”吗？</a></span></dt><dt><span class="section"><a href="firstapp.html#d0e14814">10.4.2. “开发模式”是什么意思？</a></span></dt><dt><span class="section"><a href="firstapp.html#d0e14821">10.4.3. 所生成的应用中包含了什么？</a></span></dt></dl></dd></dl></div><p>本章将帮助你快速创建一个可运行的Webx应用。你可以把它作为你的Webx新项目的开端。</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d0e14576"><!--anchor d0e14576--></a>10.1. 准备工作</h2></div></div></div><p>请耐心，准备工作会花掉你少许时间。但是磨刀不误砍柴工，做好准备工作将为你将来的开发节省大量时间。</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="d0e14581"><!--anchor d0e14581--></a>10.1.1. 安装JDK</h3></div></div></div><p>Webx需要JDK 5.0以上的版本。请从这里下载并安装它：<a class="link" href="http://www.oracle.com/technetwork/java/javase/" target="_top">http://www.oracle.com/technetwork/java/javase/</a>。</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="d0e14588"><!--anchor d0e14588--></a>10.1.2. 安装和配置maven</h3></div></div></div><p>Webx需要maven 2或更高版本。请从这里下载并安装它：<a class="link" href="http://maven.apache.org/" target="_top">http://maven.apache.org/</a>。</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"/></td><th align="left">注意</th></tr><tr><td align="left" valign="top"><p>你不需要对maven进行特殊的配置，因为运行Webx应用所需要的所有包都存放在全世界共享的中心Maven仓库（Central Maven
                    Repository）中。Maven将从那里自动获取所有的jar包、源代码和javadoc。</p><p>你可以从这里查询到所有和Webx有关的发布包：<a class="link" href="http://search.maven.org/#search%7Cga%7C1%7Ccom.alibaba.citrus" target="_top">http://search.maven.org/#search%7Cga%7C1%7Ccom.alibaba.citrus</a>。</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="d0e14602"><!--anchor d0e14602--></a>10.1.3. 安装集成开发环境</h3></div></div></div><p>很难想像不用集成开发环境（IDE）来帮助开发Java应用会变成怎样。</p><p>如果你使用Eclipse（从这里下载：<a class="link" href="http://www.eclipse.org/" target="_top">http://www.eclipse.org/</a>），建议安装如下插件：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Maven eclipse插件：<a class="link" href="http://eclipse.org/m2e/" target="_top">http://eclipse.org/m2e/</a></p></li><li class="listitem"><p>Git eclipse插件：<a class="link" href="http://eclipse.org/egit/" target="_top">http://eclipse.org/egit/</a></p></li><li class="listitem"><p>SpringExt eclipse插件：<a class="link" href="http://openwebx.org/updatesite/" target="_top">http://openwebx.org/updatesite/</a></p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"/></td><th align="left">注意</th></tr><tr><td align="left" valign="top"><p>关于SpringExt eclipse插件，请参阅更详细的说明：<a class="xref" href="springext-plugin.html#tool.plugin.springext.eclipse" title="12.3. Eclipse插件">第 12.3 节 “Eclipse插件”</a>。</p></td></tr></table></div></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d0e14629"><!--anchor d0e14629--></a>10.2. 创建应用</h2></div></div></div><p>请打开命令行工具（Windows <span class="command"><strong>cmd</strong></span>或Unix/Linux
            <span class="command"><strong>bash</strong></span>），输入如下命令：</p><div class="example"><a id="d0e14640"><!--anchor d0e14640--></a><p class="title"><strong>例 10.1. 从archetype创建Webx应用</strong></p><div class="example-contents"><pre class="programlisting">mvn archetype:generate \
 -DgroupId=com.alibaba.webx \<a id="co.firstapp.archetype.groupId"><!--anchor co.firstapp.archetype.groupId--></a><span class="calloutno"><img src="images/callouts/1.png" border="0"/></span>
 -DartifactId=tutorial1 \<a id="co.firstapp.archetype.artifactId"><!--anchor co.firstapp.archetype.artifactId--></a><span class="calloutno"><img src="images/callouts/2.png" border="0"/></span>
 -Dversion=1.0-SNAPSHOT \<a id="co.firstapp.archetype.version"><!--anchor co.firstapp.archetype.version--></a><span class="calloutno"><img src="images/callouts/3.png" border="0"/></span>
 -Dpackage=com.alibaba.webx.tutorial1 \<a id="co.firstapp.archetype.package"><!--anchor co.firstapp.archetype.package--></a><span class="calloutno"><img src="images/callouts/4.png" border="0"/></span>
 -DarchetypeArtifactId=archetype-webx-quickstart \
 -DarchetypeGroupId=com.alibaba.citrus.sample \
 -DarchetypeVersion=1.8 \
 -DinteractiveMode=false</pre><p>由于Windows下不支持命令换行，请改用<span class="emphasis"><em>非换行版</em></span>：</p><pre class="programlisting">mvn archetype:generate -DgroupId=com.alibaba.webx -DartifactId=tutorial1 -Dversion=1.0-SNAPSHOT -Dpackage=com.alibaba.webx.tutorial1 -DarchetypeArtifactId=archetype-webx-quickstart -DarchetypeGroupId=com.alibaba.citrus.sample -DarchetypeVersion=1.8 -DinteractiveMode=false</pre><p>命令执行完后，你会看见一个新目录：<code class="code">tutorial1</code>。它就是我们刚刚创建的新项目。项目的各项参数如下所示：</p><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co.firstapp.archetype.groupId"><span class="calloutno"><img src="images/callouts/1.png" border="0"/></span></a> </p></td><td valign="top" align="left"><p>项目组（<code class="code">groupId</code>）：<code class="code">com.alibaba.webx</code>。</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.firstapp.archetype.artifactId"><span class="calloutno"><img src="images/callouts/2.png" border="0"/></span></a> </p></td><td valign="top" align="left"><p>项目名称（<code class="code">artifactId</code>）：<code class="code">tutorial1</code>。</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.firstapp.archetype.version"><span class="calloutno"><img src="images/callouts/3.png" border="0"/></span></a> </p></td><td valign="top" align="left"><p>项目版本（<code class="code">version</code>）：<code class="code">1.0-SNAPSHOT</code>。</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.firstapp.archetype.package"><span class="calloutno"><img src="images/callouts/4.png" border="0"/></span></a> </p></td><td valign="top" align="left"><p>项目中Java类的包名（<code class="code">package</code>）：<code class="code">com.alibaba.webx.tutorial1</code>。</p></td></tr></table></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"/></td><th align="left">注意</th></tr><tr><td align="left" valign="top"><p>你完全可以根据你的需要来调整上述命令中的参数，改用其它的<code class="code">groupId</code>、<code class="code">artifactId</code>、<code class="code">version</code>以及<code class="code">package</code>。</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d0e14717"><!--anchor d0e14717--></a>10.3. 运行应用</h2></div></div></div><p>进入刚创建的<code class="code">tutorial1</code>目录，在此目录下执行maven命令：</p><div class="example"><a id="d0e14725"><!--anchor d0e14725--></a><p class="title"><strong>例 10.2. 启动Jetty服务器</strong></p><div class="example-contents"><pre class="programlisting">mvn jetty:run</pre></div></div><p>这条命令会启动Jetty Server，默认的端口是<code class="code">8081</code>。请在浏览器地址栏输入地址，或直接点击这个链接：<a class="link" href="http://localhost:8081/" target="_top">http://localhost:8081/</a>。你应该可以看到类似下面的结果：</p><div class="figure"><a id="d0e14737"><!--anchor d0e14737--></a><div class="figure-contents"><div class="mediaobject"><img src="images/tut/firstapp-home.png" alt="Webx开发者首页"/></div></div><p class="title"><strong>图 10.1. Webx开发者首页</strong></p></div><p>这是一个“开发者首页”。它不是真正的应用程序首页，而是一个<span class="emphasis"><em>专为开发者准备的</em></span>首页。这个页面显示了一些诸如Webx版本、Java版本、OS类型、IP地址、内存等信息。</p><p>请点击页面顶部的菜单中的Application Home，</p><div class="informalfigure"><div class="mediaobject"><img src="images/tut/firstapp-apphome-link.png"/></div></div><p>这样就可以进入<span class="emphasis"><em>真正的应用程序首页</em></span>：</p><div class="figure"><a id="d0e14759"><!--anchor d0e14759--></a><div class="figure-contents"><div class="mediaobject"><img src="images/tut/firstapp-apphome.png" alt="Webx应用首页"/></div></div><p class="title"><strong>图 10.2. Webx应用首页</strong></p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d0e14765"><!--anchor d0e14765--></a>10.4. 提问和解答</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="d0e14768"><!--anchor d0e14768--></a>10.4.1. 在生产环境的应用上，也会出现前述的“开发者首页”吗？</h3></div></div></div><p>不会的。</p><p>事实上，之所以刚才的运行会产生“开发者首页”，是因为在jetty启动时，定义了一个启动参数。请打开<code class="filename">pom.xml</code>看一下：</p><div class="example"><a id="d0e14778"><!--anchor d0e14778--></a><p class="title"><strong>例 10.3. 定义“开发者模式”的启动参数</strong></p><div class="example-contents"><pre class="programlisting"><span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<strong class="hl-tag" style="color: #000096">&lt;project</strong> <span class="hl-attribute" style="color: #F5844C">xmlns</span>=<span class="hl-value" style="color: #993300">"http://maven.apache.org/POM/4.0.0"</span> <span class="hl-attribute" style="color: #F5844C">xmlns:xsi</span>=<span class="hl-value" style="color: #993300">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hl-attribute" style="color: #F5844C">xsi:schemaLocation</span>=<span class="hl-value" style="color: #993300">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
    ...
    <strong class="hl-tag" style="color: #000096">&lt;build&gt;</strong>
        <strong class="hl-tag" style="color: #000096">&lt;plugins&gt;</strong>
            ...
            <strong class="hl-tag" style="color: #000096">&lt;plugin&gt;</strong>
                <strong class="hl-tag" style="color: #000096">&lt;groupId&gt;</strong>org.mortbay.jetty<strong class="hl-tag" style="color: #000096">&lt;/groupId&gt;</strong>
                <strong class="hl-tag" style="color: #000096">&lt;artifactId&gt;</strong>jetty-maven-plugin<strong class="hl-tag" style="color: #000096">&lt;/artifactId&gt;</strong>
                <strong class="hl-tag" style="color: #000096">&lt;configuration&gt;</strong>
                    <strong class="hl-tag" style="color: #000096">&lt;webApp&gt;</strong>
                        <strong class="hl-tag" style="color: #000096">&lt;contextPath&gt;</strong>/<strong class="hl-tag" style="color: #000096">&lt;/contextPath&gt;</strong>
                    <strong class="hl-tag" style="color: #000096">&lt;/webApp&gt;</strong>
                    <strong class="hl-tag" style="color: #000096">&lt;stopKey&gt;</strong>webx<strong class="hl-tag" style="color: #000096">&lt;/stopKey&gt;</strong>
                    <strong class="hl-tag" style="color: #000096">&lt;stopKey&gt;</strong>9999<strong class="hl-tag" style="color: #000096">&lt;/stopKey&gt;</strong>
                    <strong class="hl-tag" style="color: #000096">&lt;connectors&gt;</strong>
                        <strong class="hl-tag" style="color: #000096">&lt;connector</strong> <span class="hl-attribute" style="color: #F5844C">implementation</span>=<span class="hl-value" style="color: #993300">"org.eclipse.jetty.server.nio.SelectChannelConnector"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
                            <strong class="hl-tag" style="color: #000096">&lt;port&gt;</strong>8081<strong class="hl-tag" style="color: #000096">&lt;/port&gt;</strong>
                            <strong class="hl-tag" style="color: #000096">&lt;maxIdleTime&gt;</strong>60000<strong class="hl-tag" style="color: #000096">&lt;/maxIdleTime&gt;</strong>
                        <strong class="hl-tag" style="color: #000096">&lt;/connector&gt;</strong>
                    <strong class="hl-tag" style="color: #000096">&lt;/connectors&gt;</strong>
                    <strong class="hl-tag" style="color: #000096">&lt;requestLog</strong> <span class="hl-attribute" style="color: #F5844C">implementation</span>=<span class="hl-value" style="color: #993300">"org.eclipse.jetty.server.NCSARequestLog"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
                        <strong class="hl-tag" style="color: #000096">&lt;filename&gt;</strong>target/access.log<strong class="hl-tag" style="color: #000096">&lt;/filename&gt;</strong>
                        <strong class="hl-tag" style="color: #000096">&lt;retainDays&gt;</strong>90<strong class="hl-tag" style="color: #000096">&lt;/retainDays&gt;</strong>
                        <strong class="hl-tag" style="color: #000096">&lt;append&gt;</strong>false<strong class="hl-tag" style="color: #000096">&lt;/append&gt;</strong>
                        <strong class="hl-tag" style="color: #000096">&lt;extended&gt;</strong>false<strong class="hl-tag" style="color: #000096">&lt;/extended&gt;</strong>
                        <strong class="hl-tag" style="color: #000096">&lt;logTimeZone&gt;</strong>GMT+8:00<strong class="hl-tag" style="color: #000096">&lt;/logTimeZone&gt;</strong>
                    <strong class="hl-tag" style="color: #000096">&lt;/requestLog&gt;</strong>
                    <strong class="hl-tag" style="color: #000096">&lt;systemProperties&gt;</strong>
                        <strong class="hl-tag" style="color: #000096">&lt;systemProperty&gt;</strong>
                            <strong class="hl-tag" style="color: #000096">&lt;name&gt;</strong>productionMode<strong class="hl-tag" style="color: #000096">&lt;/name&gt;</strong> <a id="co.firstapp.pom.productionMode"><!--anchor co.firstapp.pom.productionMode--></a><span class="calloutno"><img src="images/callouts/1.png" border="0"/></span>
                            <strong class="hl-tag" style="color: #000096">&lt;value&gt;</strong>false<strong class="hl-tag" style="color: #000096">&lt;/value&gt;</strong>
                        <strong class="hl-tag" style="color: #000096">&lt;/systemProperty&gt;</strong>
                    <strong class="hl-tag" style="color: #000096">&lt;/systemProperties&gt;</strong>
                <strong class="hl-tag" style="color: #000096">&lt;/configuration&gt;</strong>
            <strong class="hl-tag" style="color: #000096">&lt;/plugin&gt;</strong>
            ...
        <strong class="hl-tag" style="color: #000096">&lt;/plugins&gt;</strong>
    <strong class="hl-tag" style="color: #000096">&lt;/build&gt;</strong>
<strong class="hl-tag" style="color: #000096">&lt;/project&gt;</strong></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co.firstapp.pom.productionMode"><span class="calloutno"><img src="images/callouts/1.png" border="0"/></span></a> </p></td><td valign="top" align="left"><p>设定JVM启动参数：<code class="code">productionMode=false</code>。</p></td></tr></table></div></div></div><p>如果不加特别设置，系统的默认状态是“生产模式”，即<code class="code">productionMode</code>默认为<code class="code">true</code>。因此，生产环境的服务器总是运行在“生产模式”而不是“开发模式”下的。而“开发者首页”只会出现在“开发模式”下面。</p><p>你可以用下面的命令来覆盖<code class="filename">pom.xml</code>的设置：</p><div class="example"><a id="d0e14805"><!--anchor d0e14805--></a><p class="title"><strong>例 10.4. 在命令行上指定JVM参数</strong></p><div class="example-contents"><pre class="programlisting">mvn jetty:run -DproductionMode=true</pre></div></div><p>然后在浏览器地址栏输入地址，或直接点击这个链接：<a class="link" href="http://localhost:8081/" target="_top">http://localhost:8081/</a>，你将直接被带入应用首页，而不是“开发者首页”。</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="d0e14814"><!--anchor d0e14814--></a>10.4.2. “开发模式”是什么意思？</h3></div></div></div><p>开发模式是为了方便应用开发，Webx所提供的额外功能。具体请见：<a class="xref" href="webxframework.html#webx.overview.framework.devmode" title="3.2.4. 开发模式工具">第 3.2.4 节 “开发模式工具”</a>。</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="d0e14821"><!--anchor d0e14821--></a>10.4.3. 所生成的应用中包含了什么？</h3></div></div></div><p>这个应用程序包含了几个Webx应用的常见元素：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>一个欢迎页面（index screen）</p></li><li class="listitem"><p>一个页面布局（layout）</p></li><li class="listitem"><p>一个表单验证（form）</p></li><li class="listitem"><p>一个action，用来处理用户提交的数据</p></li><li class="listitem"><p>Logback日志被打印在屏幕上</p></li></ul></div><p>
            </p></div></div></div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="pt04.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="pt04.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="logging.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">部分 IV. Webx应用实作 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 第 11 章 Webx日志系统的配置</td></tr></table></div></body></html>